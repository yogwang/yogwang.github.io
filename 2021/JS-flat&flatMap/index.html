<!DOCTYPE html>
<html lang="zh">
  <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>ES6 中的数组拓展方法 flat() &amp; flatMap() | blog [ YOG WANG ]</title>
  <meta name="keywords" content="YogWang,blog,web-frontend" />
  <meta name="description" content="Here is my blog, my notes and some thoughts" />
  <meta name="author" content="YogWang" />
  <meta name="google-site-verification" content="C6xTGgRjDkU2yb8izJ39IyLjwUMbDpXiATd2a-WLg5U" />
  
  
<link rel="stylesheet" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css">

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.3.0"></head>

  <body>
    <header id="header">
  <a class="header-sign" href="/">
    <img src="/favicon.png" alt="sign" />
    <span>YOG<br />WANG</span>
  </a>
  <nav class="header-navbar">
    
    <a class="nav-link" href="/archives">文章</a>
    
    <a class="nav-link" href="/about">我</a>
    
    <a class="nav-link" target="_blank" rel="noopener" href="https://github.com/yogwang">GitHub</a>
    
  </nav>
</header>

    <div id="wrap">
      <main id="container">
  <div
  id="post-JS-flat&amp;flatMap"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
>
  <div class="article-inner">
    <div class="article-meta">
      <p class="article-date">
  <time datetime="2021-05-17T06:14:01.000Z" itemprop="datePublished">2021-05-17</time>
</p> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a>
  </div>

    </div>
    
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      ES6 中的数组拓展方法 flat() &amp; flatMap()
    </h1>
  

    </header>
    
    <div class="article-entry" itemprop="articleBody">
       
  <article class="article-content">
    <p>之前有使用过 <code>flat()</code> 方法，但是一直不知道 <code>flatMap()</code> 方法，在使用 <code>map()</code> 方法组装集合的时候，在组装完成之后还要链式调用一下 <code>flat()</code>，如果可以知道 <code>flatMap()</code> 代码还能精简一点，也方便递归返回的数组内容。</p>
<p>本来是上个月发现的，但隔了一个月才有时间写，已经想不起来当时怎么发现的 <code>flatMap()</code> 这个方法了…<br>就直接跳过前置场景，直接开始聊这两个扩展方法吧。</p>
<a id="more"></a>

<h2 id="Array-prototype-flat-depth"><a href="#Array-prototype-flat-depth" class="headerlink" title="Array.prototype.flat([depth])"></a><code>Array.prototype.flat([depth])</code></h2><blockquote>
<p><code>flat()</code> 方法会按照一个<strong>可指定的深度</strong>递归遍历数组，并将所有元素与遍历到的子数组中的元素合并为一个新数组返回，对原数据没有影响。</p>
</blockquote>
<p><code>flat()</code> 默认深度为 <code>1</code>，如果想要 “拉平” 多层的嵌套数组，可以将 <code>flat()</code> 方法的参数写成一个整数，表示想要拉平的层数。<br>✨ 如果不管有多少层嵌套，都要转成一维数组，可以用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Infinity"><strong>Infinity</strong> 关键字</a>作为参数。<br>✨ 如果原数组有空位，<code>flat()</code>方法会跳过空位(过滤掉<strong>空值</strong>)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]];</span><br><span class="line"><span class="comment">// 展开一层数组</span></span><br><span class="line">arr1.flat();</span><br><span class="line"><span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]]];</span><br><span class="line">arr2.flat();</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, [5, 6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 展开两层数组</span></span><br><span class="line">arr2.flat(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 Infinity，可展开任意深度的嵌套数组</span></span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, [<span class="number">7</span>, <span class="number">8</span>, [<span class="number">9</span>, <span class="number">10</span>]]]]];</span><br><span class="line">arr3.flat(<span class="literal">Infinity</span>);</span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flat() 方法会移除数组中的空项</span></span><br><span class="line"><span class="keyword">var</span> arr4 = [<span class="number">1</span>, <span class="number">2</span>, , <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr4.flat();</span><br><span class="line"><span class="comment">// [1, 2, 4, 5]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>很容易理解的一个方法，就是推平数组，其实成为自己想要的一维数组。不过可以接收一个 <code>depth</code> 参数，我是再写这篇笔记的时候才知道的，所以还是要多记笔记啊。</p>
<hr>
<h2 id="Array-prototype-flatMap-callback-thisArg"><a href="#Array-prototype-flatMap-callback-thisArg" class="headerlink" title="Array.prototype.flatMap(callback [, thisArg]))"></a><code>Array.prototype.flatMap(callback [, thisArg]))</code></h2><blockquote>
<p><code>flatMap()</code> 方法对原数组的每个成员执行一个函数（相当于执行 <code>Array.prototype.map()</code>），然后对返回值组成的数组执行 <code>flat()</code> 方法。该方法返回一个新数组，不改变原数组。</p>
</blockquote>
<p>这个方法如果在知道 <code>flat()</code> 方法之后直接看，就还挺清楚作用是什么的，但是一看MDN上的说明，瞬间就被迷糊了….<br>其实简单来说是先 <code>map()</code> 然后执行 <code>flat()</code> 的简化版（不能指定深度）。</p>
<p>✨ <strong><code>flatMap()</code> 只能展开一层数组</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;it&#x27;s Sunny in&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;California&quot;</span>];</span><br><span class="line"></span><br><span class="line">arr.map(<span class="function"><span class="params">x</span> =&gt;</span> x.split(<span class="string">&quot; &quot;</span>));</span><br><span class="line"><span class="comment">// [[&quot;it&#x27;s&quot;,&quot;Sunny&quot;,&quot;in&quot;],[&quot;&quot;],[&quot;California&quot;]]</span></span><br><span class="line"></span><br><span class="line">arr.map(<span class="function"><span class="params">x</span> =&gt;</span> x.split(<span class="string">&quot; &quot;</span>)).flat()</span><br><span class="line"><span class="comment">// [&quot;it&#x27;s&quot;,&quot;Sunny&quot;,&quot;in&quot;, &quot;&quot;, &quot;California&quot;]</span></span><br><span class="line"></span><br><span class="line">arr.flatMap(<span class="function"><span class="params">x</span> =&gt;</span> x.split(<span class="string">&quot; &quot;</span>));</span><br><span class="line"><span class="comment">// [&quot;it&#x27;s&quot;,&quot;Sunny&quot;,&quot;in&quot;, &quot;&quot;, &quot;California&quot;]</span></span><br></pre></td></tr></table></figure>
<h2 id="尾声"><a href="#尾声" class="headerlink" title="尾声"></a>尾声</h2><h4 id="使用-reduce-与-concat-来替代-flat-方法就不复述了，直接去看MDN上的实现就好。"><a href="#使用-reduce-与-concat-来替代-flat-方法就不复述了，直接去看MDN上的实现就好。" class="headerlink" title="使用 reduce() 与 concat() 来替代 flat() 方法就不复述了，直接去看MDN上的实现就好。"></a>使用 <code>reduce()</code> 与 <code>concat()</code> 来替代 <code>flat()</code> 方法就不复述了，直接去看MDN上的实现就好。</h4><ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flat#%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88">替代方案 - flat</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap#%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88">替代方案 - flatMap</a></li>
</ul>
<h4 id="是不是发现了一个-Infinity-关键字？这个关键字可以在哪些地方使用？"><a href="#是不是发现了一个-Infinity-关键字？这个关键字可以在哪些地方使用？" class="headerlink" title="是不是发现了一个 Infinity 关键字？这个关键字可以在哪些地方使用？"></a>是不是发现了一个 <code>Infinity</code> 关键字？这个关键字可以在哪些地方使用？</h4><p><code>Infinity</code> 是一个全局变量(只读)，大于任何值，你也可以取反 <code>-Infinity</code> 使用<br>基本上只要可以传入一个正整数来 比较 或者 迭代 的都可以使用它</p>
<h2 id="📚-资源"><a href="#📚-资源" class="headerlink" title="📚 资源"></a>📚 资源</h2><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flat">Array.prototype.flat() - JavaScript | MDN</a><br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap">Array.prototype.flatMap() - JavaScript | MDN</a><br><a target="_blank" rel="noopener" href="https://es6.ruanyifeng.com/#docs/array#%E6%95%B0%E7%BB%84%E5%AE%9E%E4%BE%8B%E7%9A%84-flat%EF%BC%8CflatMap">§ 9.数组实例的 flat()，flatMap() - 数组的扩展 - ECMAScript 6入门</a><br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Infinity">Infinity - JavaScript | MDN</a></p>
 
  </article>


    </div>
  </div>
   
<nav id="article-nav">
  
    <a href="/2021/miniprogram-devDiary-05-authorize/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">newer</strong>
      <div class="article-nav-title">
        
          微信小程序学习日记 L05 拉起授权
        
      </div>
    </a>
  
  
    <a href="/2021/vue-api-filter/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">older</strong>
      <div class="article-nav-title">VueJS 的过滤器 filter API</div>
    </a>
  
</nav>
 
</div>



</main>
<aside id="sidebar">
  
    
<section class="userinfo">
    <img src="/img/userimg.jpg" alt="王阳阳">
    <h2>王阳阳</h2>
    <span>久之须自见得</span>
    <p>ODIN.INC</p>
    <p>Jiaxing,China</p>
    <div>
      
      <a class='fa fa-github' href="https://github.com/yogwang" target="_blank"></a>
      
      <a class='fa fa-weibo' href="http://weibo.com/yooooooge" target="_blank"></a>
      
    </div>
</section>

  
    
  <section class="widget-wrap">
    <h3 class="widget-title">recent_posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/JS-proto-and-prototype/">原型链！ __proto__ 与 prototype</a>
          </li>
        
          <li>
            <a href="/2021/JS-what-dose-new-operators-do/">JS中的 new 关键字做了什么？</a>
          </li>
        
          <li>
            <a href="/2021/miniprogram-devDiary-05-authorize/">微信小程序学习日记 L05 拉起授权</a>
          </li>
        
          <li>
            <a href="/2021/JS-flat&flatMap/">ES6 中的数组拓展方法 flat() &amp; flatMap()</a>
          </li>
        
          <li>
            <a href="/2021/vue-api-filter/">VueJS 的过滤器 filter API</a>
          </li>
        
      </ul>
    </div>
  </section>

  
    
  <section class="widget-wrap">
    <h3 class="widget-title">archive</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li></ul>
    </div>
  </section>


  
    
  <section class="widget-wrap">
    <h3 class="widget-title">tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ant-Design-Vue/" rel="tag">Ant-Design-Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/" rel="tag">Apache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Axios/" rel="tag">Axios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BetterScrol-js/" rel="tag">BetterScrol.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Caddy/" rel="tag">Caddy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Canvas/" rel="tag">Canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Coding/" rel="tag">Coding</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DigitalOcean/" rel="tag">DigitalOcean</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECMAScript-6/" rel="tag">ECMAScript 6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ESlint/" rel="tag">ESlint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Electron/" rel="tag">Electron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/" rel="tag">Github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gulp/" rel="tag">Gulp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jeecg-boot/" rel="tag">Jeecg-boot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NVM/" rel="tag">NVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/" rel="tag">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHPOK/" rel="tag">PHPOK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RaspberryPi/" rel="tag">RaspberryPi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ReactJS/" rel="tag">ReactJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Server/" rel="tag">Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Three-js/" rel="tag">Three.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue-Router/" rel="tag">Vue-Router</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VueJS/" rel="tag">VueJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/" rel="tag">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tinyMCE/" rel="tag">tinyMCE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag">学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B4%E4%BC%9A%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/" rel="tag">年会开发日记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%BB%E7%BB%93/" rel="tag">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%83%85%E6%84%9F/" rel="tag">情感</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%96%E5%9D%91/" rel="tag">挖坑</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%AA%E5%AE%8C%E6%88%90/" rel="tag">未完成</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A4%BE%E7%BE%A4%E5%88%86%E4%BA%AB/" rel="tag">社群分享</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%97%AE%E9%A2%98/" rel="tag">问题</a></li></ul>
    </div>
  </section>


  
</aside>
    </div>
    <footer id="footer">
  <span>
    &copy;2019-2021 YogWang powered_by
    <a href="http://hexo.io/" target="_blank">Hexo</a>
  </span>
  <br />
  <span
    >licensed
    <a href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank"
      >CC BY-NC 4.0</a
    ></span
  >
</footer>
<div>
  <a id="gotop" class="fa fa-level-up"></a>
</div>

<script src="https://unpkg.com/jquery@3.4.1/dist/jquery.js"></script>
 
<script src="/js/common.js"></script>


  </body>
</html>
